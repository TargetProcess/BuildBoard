<div class="view">
    <div class="action-panel">
        <div class="caption">
            <entity-title entity="branch.entity"></entity-title>
            <h2 ng-show="!branch.entity">{{branchName}}</h2>
        </div>


        <div class="action-list">
            <div ng-repeat="build in builds | orderBy:timeStamp" class="item {{build.status | status}}">
                <div class="date">{{build.timeStamp | date:'M/d/yy HH:mm' }}</div>
                <div class="avatar">
                    <img title="Jenkins" src="/assets/images/jenkins.png" style="width: 32px; height: 32px;">
                </div>
                <div class="description">
                    <div class="panel-group">
                        <div class="panel">
                            <div class="panel-heading">
                                <h4 class="panel-title"><b>Build #{{build.number}} </b> <span class="changes"> was triggered. Status: {{build.status}}</span></h4>
                            </div>
                            <div class="tree" class="panel-collapse">
                                <div class="panel-body">
                                    <ul>
                                        <li ng-repeat="data in [build.node]" ng-include="'/assets/partials/buildNode.html'"></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


    </div>
    <div class="info-panel">
        <div class="item">
            <h4>Users</h4>
            <span ng-repeat="user in branch.entity.assignments" class="avatar">
                <img ng-src="{{user.avatar}}20">
                <span>{{user.firstName}} {{user.lastName}}</span>
            </span>
        </div>
        <div class="item">
            <h4>Status</h4>
            <entity-state entity="branch.entity" type="btn"></entity-state>
        </div>
        <div class="item">
           <h4>Pr</h4>
           <a ng-show="branch.pullRequest"
               class="btn pr {{ branch.pullRequest | pullRequestStatus | status }}"
               href="{{branch.pullRequest.url}}">#{{branch.pullRequest.prId}}</a>
        </div>

        <div class="item">
            <h4>Jenkins</h4>
            <div class="dropdown">
                <span style="display: none">
                    {{branch|json}}
                </span>
                <a ng-show="branch.lastBuild" href="" class="jenkins btn status {{ branch.lastBuild.status | status}} dropdown-toggle" data-toggle="dropdown" title="{{branch.lastBuild.status}}">
                    {{ branch.lastBuild.timeStamp | date }}
                </a>
                <a ng-show="!branch.lastBuild" href="" class="jenkins btn status dropdown-toggle" data-toggle="dropdown">
                    Never built
                </a>
                <ul class="dropdown-menu">
                    <li ng-show="branch.lastBuild"><a href="{{branch.lastBuild.url}}" class="jenkins active">Go to Jenkins</a></li>
                    <li ng-repeat="action in branch.buildActions"><a class="jenkins" href="" ng-click="forceBuild(action)">{{action.name}}</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>